# Бронируй столик или иди нахуй

## База данных

В качестве основной БД используется PostgreSQL. Для развертывания прежде всего необходимо установить [докер](https://docs.docker.com/get-docker/).

Чтобы поднять БД, пишем в корне репозитория:
```
sudo docker compose -f docker-compose-psql.yml up -d
```
Если вдруг захотите посмотреть логи:
```
sudo docker compose -f docker-compose-psql.yml logs
```

Лог/пас и имя БД указаны в файле *docker-compose-psql.yml*.

Нюансы с портами при запуске докера с постгре описаны [здесь](https://github.com/sameersbn/docker-postgresql/issues/112#issuecomment-579712540). Не указывайте в качестве порта хост-машины станадртный порт 5432, если вкратце.

Нюансы с прокидыванием вольюма, дабы иметь на хост-машине доступ к данным БД так и не разрешились. Инфы много, но решения не нашлось, пример [тут](https://github.com/docker-library/postgres/issues/28). Внутри контейнера все данные хранятся по дефолтному пути */var/lib/postgresql/data*. 

## Наполнение базы данных тестовыми данными

Тестовые хранятся в виде csv файлов в директории *./test_db_data*, название файла в точности соответствует таблице в бд. В файле обязательно должен быть заголовок, содержащий имена полей в соответствии с таблицей в бд. Данные разделены запятыми.

Директория *./test_db_data* должна лежать в одной директории с файлом *manage_db.py*.

Чтобы наполнить бд:

```python manage_db.py --fill_data```

Чтобы удалить данные из таблиц:

```python manage_db.py --clear_data```

Чтобы удалить все таблицы в бд:

```python manage_db.py --drop_tables```


